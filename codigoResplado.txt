CREACION DE LA API: (FUNCNIONA)

//API Conexion con el libro
fetch(SHEET_ID)//Iniciar solicitud de red para obtener el contenido de la hoja de  google
  .then((response) => response.text())//Convertiri la respuesta en formato de texto
  .then((htmlContent) => {//Procesar el contenido HTML de la hoja
    const parser = new DOMParser();//Crear un nuevo objeto analizador DOM;
    const doc = parser.parseFromString(htmlContent, "text/html");//Analizar el contenido HTML en un documento DOM

    //Buscar la Hoja en cuestion
    const sheetNames = ["lista de productos", "lista con precio"];//Definir nombres de hojas en cuestion

    const sheetTabs = doc.querySelectorAll("#sheet-menu li");//Seleccionar todos los elementos de pestanas de hojas
    const tables = doc.querySelectorAll("table");//Seleccionar todas las tablas en el documento

    sheetTabs.forEach((tab, index) => {//Interacion o bucle sobre cada pestana de hoja(tab)cen el documento. el index nos dala posicion de la pestana
      const sheetName = tab.textContent.trim().toLocaleLowerCase();//Extrae el nombre de la hoja actual, eliminiaespacio al final y al inicio y lo convierte a minusculas ya que el nombre de la hoja esta en minusculas
      if (sheetNames.includes(sheetName)) {//Verificar el nombre de la hoja actual que estan definidas en sheetNames
        const rows = tables[index].getElementsByTagName("tr");//Se crea una entrada en el objeto sheetData para esta hoja, donde la clave es el nombre de la misma

        //Convierte la coleccion de las filas en un array y mapea cada fila
        sheetData[sheetName] = Array.from(rows).map((row) =>
          Array.from(row.getElementsByTagName("td")).map(
            (cell) => cell.textContent) 
        );//Para cada fila, obtine todas las celdas <td>, las convierte en un array, y mapea cada celda a su contenido de texto
      }
    });
    //console.log("data extraida de la hoja:", sheetData);
    //sheetData = sheetData;
    handleSheetData(); //llamar a la funcion para trabajar con la data
  //Ahora se puede trabjar con las hojas
  })
  .catch((error) => console.error("Error", error));//Registrar cualquier error







||----------------------------------------------------------------------------
//Lista 1,2,3,4
    // if (sheetData['lista con precio']) {
    //   const List = sheetData['lista con precio'];
    //   const selectList = document.getElementById('lista');
    
    //   List.forEach((option, index) => {
    //     if (index > 0) { // Skip the header row
    //       const optionElement = document.createElement('option');
    //       optionElement.value = option[1];
    //       optionElement.textContent = option[1];
    //       selectList.appendChild(optionElement);
    //     }
    //   });

      
    // } else {
    //   console.log('Product list not found in sheet data');
    // }

